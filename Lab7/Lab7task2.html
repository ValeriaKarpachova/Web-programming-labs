<!doctype html>
<html lang="uk">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>–ì—Ä–∞ ¬´21¬ª</title>
  <style>
    body{font-family:Segoe UI, Roboto, Arial; background:#f3f6fb; color:#222; padding:20px;}
    .container{max-width:900px;margin:0 auto;background:#fff;padding:18px;border-radius:10px;box-shadow:0 6px 18px rgba(20,40,80,0.08)}
    h1{margin:0 0 10px;font-size:20px}
    .board{display:flex;gap:18px;flex-wrap:wrap}
    .panel{flex:1 1 300px;background:#fafbfd;border:1px solid #eef3fb;padding:12px;border-radius:8px}
    .hand{min-height:70px;margin:8px 0;padding:8px;background:#fff;border-radius:6px;border:1px dashed #e6eefc}
    .cards{display:flex;gap:8px;flex-wrap:wrap}
    .card{min-width:50px;background:linear-gradient(180deg,#fff,#f7fbff);border:1px solid #cfe3ff;padding:6px 8px;border-radius:6px;box-shadow:0 2px 4px rgba(20,60,120,0.04);font-weight:600}
    .controls{display:flex;gap:10px;margin-top:8px}
    button{padding:8px 12px;border-radius:8px;border:0;background:#2563eb;color:#fff;font-weight:600;cursor:pointer}
    button.secondary{background:#0ea5a4}
    button.ghost{background:#e6eefc;color:#2563eb}
    .status{margin-top:12px;padding:10px;background:#fff;border-radius:6px;border:1px solid #eef3fb}
    .small{font-size:13px;color:#555}
    .footer{margin-top:12px;font-size:13px;color:#666}
  </style>
</head>
<body>
  <div class="container">
    <h1>–ì—Ä–∞ ¬´21¬ª </h1>
    <p class="small">–ú–µ—Ç–∞: –Ω–∞–±—Ä–∞—Ç–∏ —è–∫–æ–º–æ–≥–∞ –±–ª–∏–∂—á–µ –¥–æ 21 –æ—á–∫–∞, –Ω–µ –ø–µ—Ä–µ–≤–∏—â–∏–≤—à–∏ –π–æ–≥–æ. –í–∞–ª—ñ–¥–∞—Ü—ñ—è –ê (—Ç—É–∑–∞) —è–∫ 11 –∞–±–æ 1 –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ.</p>

    <div class="board">
      <div class="panel">
        <h3>–ì—Ä–∞–≤–µ—Ü—å</h3>
        <div>–°—É–º–∞: <span id="playerSum">0</span></div>
        <div class="hand" id="playerHand"><div class="cards" id="playerCards"></div></div>

        <div class="controls">
          <button id="btnDraw">–í–∑—è—Ç–∏ –∫–∞—Ä—Ç—É</button>
          <button id="btnHold" class="secondary">–°—Ç–æ–ø (—á–µ–∫–∞—Ç–∏ –¥–∏–ª–µ—Ä–∞)</button>
          <button id="btnNew" class="ghost">–ù–æ–≤–∞ –≥—Ä–∞</button>
        </div>
        <div class="status" id="playerStatus">–ì–æ—Ç–æ–≤–æ –¥–æ –≥—Ä–∏.</div>
      </div>

      <div class="panel">
        <h3>–î–∏–ª–µ—Ä</h3>
        <div>–°—É–º–∞: <span id="dealerSum">0</span></div>
        <div class="hand" id="dealerHand"><div class="cards" id="dealerCards"></div></div>
        <div class="status" id="dealerStatus">–î–∏–ª–µ—Ä —á–µ–∫–∞—î.</div>
      </div>

      <div class="panel">
        <h3>–Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è</h3>
        <div id="log" class="small" style="white-space:pre-line;max-height:240px;overflow:auto;padding:8px"></div>
        <div class="footer">–ü—Ä–∞–≤–∏–ª–∞: –ê = 11 –∞–±–æ 1; K = 4, Q = 3, J = 2; –¥–∏–ª–µ—Ä —Ç—è–≥–Ω–µ –¥–æ >=17.</div>
      </div>
    </div>
  </div>

<script>

const suits = ['‚ô†','‚ô•','‚ô¶','‚ô£'];
const ranks = [
  {r:'A', v:11}, {r:'2', v:2}, {r:'3', v:3}, {r:'4', v:4}, {r:'5', v:5}, {r:'6', v:6}, {r:'7', v:7}, {r:'8', v:8}, {r:'9', v:9}, {r:'10', v:10}, {r:'J', v:2}, {r:'Q', v:3}, {r:'K', v:4}
];

function createDeck(){
  const deck = [];
  for(const s of suits){
    for(const rk of ranks){
      deck.push({rank:rk.r, suit:s, value:rk.v});
    }
  }
  return deck;
}

function shuffle(deck){
  for(let i = deck.length-1;i>0;i--){
    const j = Math.floor(Math.random()*(i+1));
    [deck[i],deck[j]] = [deck[j],deck[i]];
  }
}

function handValue(hand){
  let sum = 0;
  let aces = 0;
  for(const c of hand){
    sum += c.value;
    if(c.rank === 'A') aces++;
  }
  
  while(sum > 21 && aces>0){
    sum -= 10; 
    aces--;
  }
  return sum;
}

const playerCardsEl = document.getElementById('playerCards');
const dealerCardsEl = document.getElementById('dealerCards');
const playerSumEl = document.getElementById('playerSum');
const dealerSumEl = document.getElementById('dealerSum');
const playerStatusEl = document.getElementById('playerStatus');
const dealerStatusEl = document.getElementById('dealerStatus');
const logEl = document.getElementById('log');

const btnDraw = document.getElementById('btnDraw');
const btnHold = document.getElementById('btnHold');
const btnNew = document.getElementById('btnNew');

let deck = [];
let playerHand = [];
let dealerHand = [];
let gameOver = false;

function log(msg){
  logEl.textContent = msg + '\n' + logEl.textContent;
}

function renderHands(hideDealerHole=false){
  playerCardsEl.innerHTML = '';
  dealerCardsEl.innerHTML = '';
  for(const c of playerHand){
    const el = document.createElement('div'); el.className='card'; el.textContent = c.rank + c.suit; playerCardsEl.appendChild(el);
  }
  for(let i=0;i<dealerHand.length;i++){
    const c = dealerHand[i];
    const el = document.createElement('div'); el.className='card';
    if(hideDealerHole && i===0){ el.textContent = 'üÇ†'; } else { el.textContent = c.rank + c.suit; }
    dealerCardsEl.appendChild(el);
  }
  playerSumEl.textContent = handValue(playerHand);
  dealerSumEl.textContent = hideDealerHole ? '?' : handValue(dealerHand);
}

function startGame(){
  deck = createDeck(); shuffle(deck);
  playerHand = [];
  dealerHand = [];
  gameOver = false;
  logEl.textContent = '';
  
  playerHand.push(deck.pop());
  dealerHand.push(deck.pop());
  playerHand.push(deck.pop());
  dealerHand.push(deck.pop());
  renderHands(true);
  playerStatusEl.textContent = '–í–∞—à —Ö—ñ–¥. –¢—è–≥–Ω—ñ—Ç—å –∫–∞—Ä—Ç—É –∞–±–æ –°—Ç–æ–ø.';
  dealerStatusEl.textContent = '–î–∏–ª–µ—Ä –º–∞—î –æ–¥–Ω—É –∫–∞—Ä—Ç—É –≤ –∑–∞–∫—Ä–∏—Ç–æ–º—É.';
  log('–ù–æ–≤–∞ –≥—Ä–∞ —Ä–æ–∑–ø–æ—á–∞—Ç–∞.');
  
  if(handValue(playerHand) === 21){
    endRound();
  }
}

function playerDraw(){
  if(gameOver) return;
  playerHand.push(deck.pop());
  renderHands(true);
  log('–ì—Ä–∞–≤–µ—Ü—å —Ç—è–≥–Ω–µ –∫–∞—Ä—Ç—É.');
  const value = handValue(playerHand);
  if(value > 21){
    playerStatusEl.textContent = '–ü–µ—Ä–µ–±—ñ—Ä! –í–∏ –ø—Ä–æ–≥—Ä–∞–ª–∏.';
    log('–ì—Ä–∞–≤–µ—Ü—å –ø–µ—Ä–µ–±—Ä–∞–≤ ('+value+').');
    endRound();
  } else if(value === 21){
    playerStatusEl.textContent = '–£ –≤–∞—Å 21 ‚Äî —Å—Ç–æ–ø –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ.';
    log('–ì—Ä–∞–≤–µ—Ü—å –Ω–∞–±—Ä–∞–≤ 21.');
    dealerTurn();
  } else {
    playerStatusEl.textContent = '–í–∞—à —Ö—ñ–¥.';
  }
}

function playerHold(){
  if(gameOver) return;
  playerStatusEl.textContent = '–ì—Ä–∞–≤–µ—Ü—å —á–µ–∫–∞—î ‚Äî —Ö—ñ–¥ –¥–∏–ª–µ—Ä–∞.';
  log('–ì—Ä–∞–≤–µ—Ü—å –∑—É–ø–∏–Ω–∏–≤—Å—è. –•—ñ–¥ –¥–∏–ª–µ—Ä–∞.');
  dealerTurn();
}

async function dealerTurn(){
  renderHands(false);
  dealerStatusEl.textContent = '–î–∏–ª–µ—Ä –≥—Ä–∞—î...';
 
  while(handValue(dealerHand) < 17){
    await sleep(700);
    dealerHand.push(deck.pop());
    renderHands(false);
    log('–î–∏–ª–µ—Ä –±–µ—Ä–µ –∫–∞—Ä—Ç—É. –°—É–º–∞ –¥–∏–ª–µ—Ä–∞: '+handValue(dealerHand));
  }
  endRound();
}

function endRound(){
  gameOver = true;
  renderHands(false);
  const p = handValue(playerHand);
  const d = handValue(dealerHand);
  let message = '';
  if(p > 21){
    message = '–í–∏ –ø—Ä–æ–≥—Ä–∞–ª–∏ ‚Äî –ø–µ—Ä–µ–±—ñ—Ä.';
 } else if(d > 21){
    message = '–í–∏ –≤–∏–≥—Ä–∞–ª–∏ ‚Äî –¥–∏–ª–µ—Ä –ø–µ—Ä–µ–±—Ä–∞–≤.';
  } else if(p === d){
    message = '–ù—ñ—á–∏—è.';
  } else if(p === 21 && playerHand.length===2 && !(d===21 && dealerHand.length===2)){
    message = '–í–∏ –æ—Ç—Ä–∏–º–∞–ª–∏ Blackjack! –í–∏–≥—Ä–∞—à.';
  } else if(d === 21 && dealerHand.length===2 && !(p===21 && playerHand.length===2)){
    message = '–î–∏–ª–µ—Ä –æ—Ç—Ä–∏–º–∞–≤ Blackjack ‚Äî –≤–∏ –ø—Ä–æ–≥—Ä–∞–ª–∏.';
  } else if(p > d){
    message = '–í–∏ –≤–∏–≥—Ä–∞–ª–∏!'+ ' ('+p+' > '+d+')';
  } else {
    message = '–í–∏ –ø—Ä–æ–≥—Ä–∞–ª–∏. '+ ' ('+p+' < '+d+')';
  }
  playerStatusEl.textContent = message;
  dealerStatusEl.textContent = '–†–µ–∑—É–ª—å—Ç–∞—Ç: '+message;
  log('–†–∞—É–Ω–¥ –∑–∞–≤–µ—Ä—à–µ–Ω–æ. '+message+' (–ì—Ä–∞–≤–µ—Ü—å '+p+', –î–∏–ª–µ—Ä '+d+')');
}

function sleep(ms){ return new Promise(r=>setTimeout(r,ms)); }

btnDraw.addEventListener('click', ()=>{ playerDraw(); });
btnHold.addEventListener('click', ()=>{ playerHold(); });
btnNew.addEventListener('click', ()=>{ startGame(); });

startGame();

</script>
</body>
</html>
